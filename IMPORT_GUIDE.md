# Excel 导入学生数据功能使用指南

## 功能概述

本插件支持从 Excel 文件导入学生数据（学号、姓名），并提供随机排座功能。

## 使用步骤

### 1. 准备 Excel 文件

Excel 文件格式要求：
- **第一列**：学号（数字或文本）
- **第二列**：姓名（文本）
- 可以包含标题行（会自动识别并跳过）
- 支持格式：.xlsx、.xls、.csv

**示例格式：**

| 学号 | 姓名 |
|------|------|
| 1    | 张三 |
| 2    | 李四 |
| 3    | 王五 |

或者不带标题行：

| 1 | 张三 |
| 2 | 李四 |
| 3 | 王五 |

### 2. 导入学生数据

1. 打开 uTools 插件
2. 在右侧学生列表面板，点击右上角的 **"导入Excel"** 按钮
3. 在文件选择器中选择准备好的 Excel 文件
4. 等待导入完成

**注意事项：**
- 如果已有座位安排，会提示确认是否清空现有座位
- 导入成功后会显示导入的学生数量

### 3. 随机排座

导入成功后，系统会询问是否立即随机排座：

- **选择"随机排座"**：自动为所有学生随机分配座位
- **选择"稍后手动安排"**：可以手动拖拽学生到座位

**随机排座特点：**
- 使用 Fisher-Yates 洗牌算法，保证真正的随机性
- 如果学生数量超过座位数量，会显示警告并尽可能分配
- 如果学生数量少于座位数量，剩余座位保持空置

### 4. 后续操作

导入后，所有现有功能仍然可用：

- ✅ **拖拽调整**：可以拖拽学生到其他座位
- ✅ **搜索学生**：支持按姓名或学号搜索
- ✅ **移除学生**：鼠标悬停在座位上，点击删除图标
- ✅ **重置座位**：点击"重置座位"按钮恢复到初始配置
- ✅ **数据持久化**：所有更改自动保存，重启后保留

## 数据存储

- **学生数据**：存储在 `localStorage.studentList`
- **座位数据**：存储在 `localStorage.seatData`
- 数据在浏览器本地存储，不会上传到服务器

## 常见问题

### Q: 导入后原来的学生数据会丢失吗？

A: 是的。导入新的学生名单会替换原有数据。如果需要保留原有数据，请先备份。

### Q: 可以导入多少学生？

A: 理论上没有限制，但座位数量固定为 48 个（6行×8列）。超过 48 名学生时，多余的学生会显示在"未就座"列表中。

### Q: Excel 文件格式错误怎么办？

A: 系统会显示错误提示。请确保：
- 文件格式为 .xlsx、.xls 或 .csv
- 至少包含两列数据（学号、姓名）
- 数据行不为空

### Q: 可以重复导入吗？

A: 可以。每次导入都会替换之前的学生数据，并清空座位安排。

### Q: 在浏览器中可以使用导入功能吗？

A: 不可以。导入功能依赖 uTools 的文件系统访问能力，只能在 uTools 环境中使用。在浏览器中点击"导入Excel"会提示错误。

## 测试文件

项目根目录下提供了测试文件 `test-students.csv`，包含 8 名测试学生数据，可用于功能测试。

## 技术细节

- **Excel 解析库**：xlsx (SheetJS)
- **随机算法**：Fisher-Yates shuffle
- **数据存储**：localStorage
- **文件选择**：uTools 原生 API

## 反馈与支持

如有问题或建议，请联系开发者。
