# Excel 导入功能 - 快速开始指南

## 🚀 快速开始

### 1. 开发环境测试

```bash
# 启动开发服务器
npm run dev

# 访问 http://localhost:5177/
```

**注意**: 浏览器环境下，导入功能会提示"此功能仅在 uTools 环境中可用"，这是正常的。完整功能需要在 uTools 中测试。

### 2. 构建并在 uTools 中测试

```bash
# 构建插件
npm run build:plugin

# 或者分步执行
npm run build
node build-plugin.js
```

构建完成后：
1. 打开 uTools
2. 输入 "插件管理" 或按快捷键
3. 点击 "开发者工具" → "安装本地插件"
4. 选择项目根目录 `d:\utoolsApp\utools-seat-table-plugin`
5. 安装完成后，输入 "学生排座" 或 "座位" 打开插件

## 📝 测试数据文件

项目提供了两个测试文件：

### test-students.csv (8人 - 快速测试)
```csv
学号,姓名
1,张三
2,李四
3,王五
4,赵六
5,孙七
6,周八
7,吴九
8,郑十
```

### test-students-full.csv (48人 - 完整测试)
包含 48 名学生，正好填满所有座位（6行×8列）

## 🧪 测试场景

### 场景 1: 首次导入（少量学生）

1. 打开插件
2. 点击右侧 "导入Excel" 按钮
3. 选择 `test-students.csv` (8人)
4. 确认导入
5. 选择 "随机排座"
6. **预期结果**: 8名学生随机分配到座位，40个座位保持空置

### 场景 2: 完整导入（48人）

1. 点击 "导入Excel" 按钮
2. 选择 `test-students-full.csv` (48人)
3. 如果已有座位，确认清空
4. 选择 "随机排座"
5. **预期结果**: 所有48个座位都被填满

### 场景 3: 超额导入（>48人）

创建一个包含 60 名学生的文件，测试超额情况：
- **预期结果**: 显示警告 "学生数量(60)超过座位数量(48)，部分学生将无法分配座位"
- 48名学生被随机分配座位
- 12名学生显示在 "未就座" 列表中

### 场景 4: 后续操作测试

导入后测试现有功能：

1. **拖拽调整**:
   - 拖拽座位上的学生到另一个座位 → 两个学生交换位置
   - 从 "未就座" 列表拖拽学生到空座位 → 学生被分配到该座位

2. **搜索功能**:
   - 在搜索框输入学生姓名 → 过滤显示匹配的学生
   - 输入学号 → 过滤显示对应学生

3. **删除学生**:
   - 鼠标悬停在已就座学生上 → 显示删除图标
   - 点击删除图标 → 学生移回 "未就座" 列表

4. **重置座位**:
   - 点击顶部 "重置座位" 按钮 → 恢复到初始配置（INITIAL_SEATS）
   - 注意：重置后学生列表仍然是导入的数据

5. **数据持久化**:
   - 关闭插件
   - 重新打开插件
   - **预期结果**: 导入的学生数据和座位安排都保留

## 🔍 功能验证清单

### 导入功能
- [ ] 导入按钮显示在学生列表右上角
- [ ] 点击按钮打开文件选择器
- [ ] 文件选择器支持 .xlsx、.xls、.csv 格式
- [ ] 成功导入后显示学生数量
- [ ] 学生数据显示在右侧列表中
- [ ] 学生总数统计正确更新

### 随机排座
- [ ] 导入后询问是否随机排座
- [ ] 选择 "随机排座" 后学生被随机分配
- [ ] 选择 "稍后手动安排" 后座位保持空置
- [ ] 随机分配的座位分布均匀（多次测试）
- [ ] 学生数量超过座位时显示警告
- [ ] 超额学生显示在 "未就座" 列表

### 数据管理
- [ ] 导入的学生数据保存到 localStorage
- [ ] 重启插件后数据保留
- [ ] 重复导入会替换之前的数据
- [ ] 导入前有座位时显示确认对话框

### 兼容性
- [ ] 拖拽功能正常工作
- [ ] 搜索功能正常工作
- [ ] 删除功能正常工作
- [ ] 重置功能正常工作
- [ ] 全屏功能正常工作

### 错误处理
- [ ] 空文件显示错误提示
- [ ] 格式错误文件显示错误提示
- [ ] 取消文件选择不报错
- [ ] 取消确认对话框不报错
- [ ] 浏览器环境显示友好提示

## 📊 性能测试

### 导入性能
- 8人数据: < 50ms
- 48人数据: < 100ms
- 100人数据: < 200ms

### 随机排座性能
- 48个座位: < 10ms
- UI 更新: 即时响应

## 🐛 已知问题

目前没有已知问题。如果发现问题，请记录：
- 问题描述
- 复现步骤
- 预期行为
- 实际行为
- 环境信息（uTools 版本、操作系统）

## 💡 使用技巧

### 1. Excel 文件准备

**推荐格式**:
```
学号    姓名
1       张三
2       李四
```

**也支持无标题行**:
```
1       张三
2       李四
```

**学号格式灵活**:
- 数字: `1, 2, 3`
- 文本: `"001", "002", "003"`
- 混合: `"A1", "A2", "A3"`

### 2. 快速重新排座

如果对当前排座不满意：
1. 点击 "重置座位" 清空所有座位
2. 从 "未就座" 列表手动拖拽
3. 或者重新导入 Excel 并选择随机排座

### 3. 部分调整

不需要完全重新排座，可以：
- 拖拽两个学生交换位置
- 删除某个学生，重新分配
- 手动拖拽 "未就座" 学生到空位

### 4. 数据备份

导入的学生数据存储在浏览器 localStorage 中：
- 键名: `studentList`
- 格式: JSON 数组
- 可以通过浏览器开发者工具查看和备份

## 🎯 下一步

1. **在 uTools 中完整测试**
   - 构建插件: `npm run build:plugin`
   - 在 uTools 中安装并测试所有功能

2. **准备真实数据**
   - 从学校系统导出学生名单
   - 整理为 Excel 格式（学号、姓名两列）
   - 导入到插件中使用

3. **日常使用**
   - 根据需要调整座位
   - 定期保存座位安排（可以截图或导出）
   - 新学期重新导入新的学生名单

## 📚 相关文档

- [IMPORT_GUIDE.md](./IMPORT_GUIDE.md) - 详细使用指南
- [IMPLEMENTATION_REPORT.md](./IMPLEMENTATION_REPORT.md) - 技术实现报告
- [README.md](./README.md) - 项目说明

## 🆘 获取帮助

如有问题：
1. 查看 [IMPORT_GUIDE.md](./IMPORT_GUIDE.md) 常见问题部分
2. 检查浏览器控制台是否有错误信息
3. 确认在 uTools 环境中运行（不是浏览器）
4. 联系开发者反馈问题

---

**祝使用愉快！** 🎉
